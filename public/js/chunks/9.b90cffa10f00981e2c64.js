webpackJsonp([9],{"38fF":function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("BO1k"),i=e.n(a),s=e("woOf"),r=e.n(s),o=e("CgzK"),l=e("JSPZ"),c=e("oPgi");Object(l.a)();var u=e("g3WJ"),d=(e("nx/F"),[{key:"web",display_name:"web"},{key:"api",display_name:"api"}]),p=d.reduce(function(n,t){return n[t.key]=t.display_name,n},{});t.default={name:"permissionList",directives:{waves:u.a},filters:{statusFilter:function(n){return{published:"success",draft:"info",deleted:"danger"}[n]},typeFilter:function(n){return p[n]}},data:function(){return{tableKey:0,list:null,total:null,listLoading:!0,listQuery:{page:1,importance:void 0,name:void 0,guard_name:void 0},calendarTypeOptions:d,showReviewer:!1,temp:{id:void 0,name:"",guard_name:"",description:"",group:""},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑权限",create:"新增权限"},dialogPvVisible:!1,pvData:[],rules:{guard_name:[{required:!0,message:"请选择标识",trigger:"change"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],group:[{required:!0,message:"请输入分组",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}]},downloadLoading:!1}},created:function(){this.getList()},methods:{getList:function(){var n=this;this.listLoading=!0,function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(l.a)();return Object(o.a)({url:c.a.API_URL+"/permissionList",method:"get",params:{token:t,page:n.page}})}(this.listQuery).then(function(t){n.list=t.data.data,n.total=t.data.total,setTimeout(function(){n.listLoading=!1},1500)})},handleFilter:function(){this.listQuery.page=1,this.getList()},handleSizeChange:function(n){this.listQuery.limit=n,this.getList()},handleCurrentChange:function(n){this.listQuery.page=n,this.getList()},handleModifyStatus:function(n,t){var e=this;this.$confirm("确定要删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.temp=r()({},n),function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(l.a)();return Object(o.a)({url:c.a.API_URL+"/permission/"+n.id,method:"delete",params:{token:t},data:n})}(e.temp).then(function(t){if(0===t.data.status)e.$notify({title:"失败",message:"删除失败",type:"warning",duration:2e3});else{var a=e.list.indexOf(n);e.list.splice(a,1),e.dialogFormVisible=!1,e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})}})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},resetTemp:function(){this.temp={id:void 0,name:"",guard_name:"",description:"",group:""}},handleCreate:function(){var n=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){n.$refs.dataForm.clearValidate()})},createData:function(){var n=this;this.$refs.dataForm.validate(function(t){t&&function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(l.a)();return Object(o.a)({url:c.a.API_URL+"/permission",method:"post",data:n,params:{token:t}})}(n.temp).then(function(t){n.temp.id=t.data.id,n.list.unshift(n.temp),n.dialogFormVisible=!1,n.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})})})},handleUpdate:function(n){var t=this;this.temp=r()({},n),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},updateData:function(){var n=this;this.$refs.dataForm.validate(function(t){if(t){var e=r()({},n.temp);console.log(e),function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(l.a)();return Object(o.a)({url:c.a.API_URL+"/permission/"+n.id,method:"put",params:{token:t},data:n})}(e).then(function(){var t=!0,e=!1,a=void 0;try{for(var s,r=i()(n.list);!(t=(s=r.next()).done);t=!0){var o=s.value;if(o.id===n.temp.id){var l=n.list.indexOf(o);n.list.splice(l,1,n.temp);break}}}catch(n){e=!0,a=n}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}n.dialogFormVisible=!1,n.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})})}})},handleDelete:function(n){this.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3});var t=this.list.indexOf(n);this.list.splice(t,1)}}}},Aj3u:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,".waves-ripple {\r\n    position: absolute;\r\n    border-radius: 100%;\r\n    background-color: rgba(0, 0, 0, 0.15);\r\n    background-clip: padding-box;\r\n    pointer-events: none;\r\n    -webkit-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    -webkit-transform: scale(0);\r\n    -ms-transform: scale(0);\r\n    transform: scale(0);\r\n    opacity: 1;\r\n}\r\n\r\n.waves-ripple.z-active {\r\n    opacity: 0;\r\n    -webkit-transform: scale(2);\r\n    -ms-transform: scale(2);\r\n    transform: scale(2);\r\n    -webkit-transition: opacity 1.2s ease-out, -webkit-transform 0.6s ease-out;\r\n    transition: opacity 1.2s ease-out, -webkit-transform 0.6s ease-out;\r\n    transition: opacity 1.2s ease-out, transform 0.6s ease-out;\r\n    transition: opacity 1.2s ease-out, transform 0.6s ease-out, -webkit-transform 0.6s ease-out;\r\n}",""])},HvqE:function(n,t,e){var a=e("VU/8")(e("38fF"),e("NO1u"),!1,function(n){e("QU6X")},null,null);n.exports=a.exports},NO1u:function(n,t){n.exports={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"app-container"},[e("div",{staticClass:"filter-container"},[e("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:n.handleCreate}},[n._v("\n      "+n._s(n.$t("table.add"))+"\n    ")])],1),n._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.listLoading,expression:"listLoading"}],key:n.tableKey,staticStyle:{width:"100%"},attrs:{data:n.list,border:"",fit:"","highlight-current-row":""}},[e("el-table-column",{attrs:{label:n.$t("table.id"),align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("span",[n._v(n._s(t.row.id))])]}}])}),n._v(" "),e("el-table-column",{attrs:{label:n.$t("permission.name"),align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("span",[n._v(n._s(t.row.name))])]}}])}),n._v(" "),e("el-table-column",{attrs:{label:n.$t("permission.guard_name"),align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("span",[n._v(n._s(t.row.guard_name))])]}}])}),n._v(" "),e("el-table-column",{attrs:{label:n.$t("permission.description"),align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("span",[n._v(n._s(t.row.description))])]}}])}),n._v(" "),e("el-table-column",{attrs:{label:n.$t("permission.group"),align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("span",[n._v(n._s(t.row.group))])]}}])}),n._v(" "),e("el-table-column",{attrs:{label:n.$t("table.actions"),align:"center","class-name":"small-padding fixed-width"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){n.handleUpdate(t.row)}}},[n._v(n._s(n.$t("table.edit")))]),n._v(" "),"deleted"!=t.row.status?e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){n.handleModifyStatus(t.row,"deleted")}}},[n._v(n._s(n.$t("table.delete"))+"\n        ")]):n._e()]}}])})],1),n._v(" "),e("div",{staticClass:"pagination-container"},[e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:n.total>0,expression:"total>0"}],attrs:{"current-page":n.listQuery.page,total:n.total,background:"",layout:"total, prev, pager, next"},on:{"current-change":n.handleCurrentChange}})],1),n._v(" "),e("el-dialog",{attrs:{title:n.textMap[n.dialogStatus],visible:n.dialogFormVisible},on:{"update:visible":function(t){n.dialogFormVisible=t}}},[e("el-form",{ref:"dataForm",staticStyle:{width:"400px"},attrs:{rules:n.rules,model:n.temp,"label-position":"left","label-width":"100px"}},[e("el-form-item",{attrs:{label:n.$t("permission.name"),prop:"name"}},[e("el-input",{model:{value:n.temp.name,callback:function(t){n.$set(n.temp,"name",t)},expression:"temp.name"}})],1),n._v(" "),e("el-form-item",{attrs:{label:n.$t("permission.description"),prop:"description"}},[e("el-input",{model:{value:n.temp.description,callback:function(t){n.$set(n.temp,"description",t)},expression:"temp.description"}})],1),n._v(" "),e("el-form-item",{attrs:{label:n.$t("permission.group"),prop:"group"}},[e("el-input",{model:{value:n.temp.group,callback:function(t){n.$set(n.temp,"group",t)},expression:"temp.group"}})],1),n._v(" "),e("el-form-item",{attrs:{label:n.$t("permission.guard_name"),prop:"guard_name"}},[e("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择标识"},model:{value:n.temp.guard_name,callback:function(t){n.$set(n.temp,"guard_name",t)},expression:"temp.guard_name"}},n._l(n.calendarTypeOptions,function(n){return e("el-option",{key:n.key,attrs:{label:n.display_name,value:n.key}})}))],1)],1),n._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(t){n.dialogFormVisible=!1}}},[n._v(n._s(n.$t("table.cancel")))]),n._v(" "),"create"==n.dialogStatus?e("el-button",{attrs:{type:"primary"},on:{click:n.createData}},[n._v(n._s(n.$t("table.confirm")))]):e("el-button",{attrs:{type:"primary"},on:{click:n.updateData}},[n._v(n._s(n.$t("table.confirm")))])],1)],1),n._v(" "),e("el-dialog",{attrs:{visible:n.dialogPvVisible,title:"Reading statistics"},on:{"update:visible":function(t){n.dialogPvVisible=t}}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:n.pvData,border:"",fit:"","highlight-current-row":""}},[e("el-table-column",{attrs:{prop:"key",label:"Channel"}}),n._v(" "),e("el-table-column",{attrs:{prop:"pv",label:"Pv"}})],1),n._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(t){n.dialogPvVisible=!1}}},[n._v(n._s(n.$t("table.confirm")))])],1)],1)],1)},staticRenderFns:[]}},Oby4:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* .fixed-width .el-button--mini {\n  padding: 10px 3px;\n  width: 70px;\n  margin-left: 0px;\n}\n.el-table--medium td, .el-table--medium th {\n  padding: 7px 0;\n}  */\n",""])},QU6X:function(n,t,e){var a=e("Oby4");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("po5z")("6a255aa6",a,!0,{})},g3WJ:function(n,t,e){"use strict";var a=e("woOf"),i=e.n(a),s=(e("lBjm"),{bind:function(n,t){n.addEventListener("click",function(e){var a=i()({},t.value),s=i()({ele:n,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),r=s.ele;if(r){r.style.position="relative",r.style.overflow="hidden";var o=r.getBoundingClientRect(),l=r.querySelector(".waves-ripple");switch(l?l.className="waves-ripple":((l=document.createElement("span")).className="waves-ripple",l.style.height=l.style.width=Math.max(o.width,o.height)+"px",r.appendChild(l)),s.type){case"center":l.style.top=o.height/2-l.offsetHeight/2+"px",l.style.left=o.width/2-l.offsetWidth/2+"px";break;default:l.style.top=(e.pageY-o.top-l.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",l.style.left=(e.pageX-o.left-l.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return l.style.backgroundColor=s.color,l.className="waves-ripple z-active",!1}},!1)}}),r=function(n){n.directive("waves",s)};window.Vue&&(window.waves=s,Vue.use(r)),s.install=r;t.a=s},lBjm:function(n,t,e){var a=e("Aj3u");"string"==typeof a&&(a=[[n.i,a,""]]);var i={transform:void 0};e("MTIv")(a,i);a.locals&&(n.exports=a.locals)}});